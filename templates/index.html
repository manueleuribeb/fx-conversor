<!doctype html>
<html lang="es">
  <head>
    <meta charset="utf-8">
    <title>FX Conversor BFSI</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap 5 CDN -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    >

    <style>
      body { background-color: #0b1020; color: #f8f9fa; }
      .card { background-color: #151a2c; border-radius: 1rem; }
      .tcs-brand { color: #00bcd4; font-weight: 600; letter-spacing: 0.08em; }
      .result-box { background-color: #0f172a; border-radius: 0.75rem; color: #f8f9fa; }
      .form-label { color: #f8f9fa; font-weight: 500; }
    </style>
  </head>
  <body>
    <div class="container py-5">
      <div class="row justify-content-center">
        <div class="col-lg-8">
          <div class="mb-4 text-center">
            <div class="tcs-brand">BFSI · Energy & Resources</div>
            <h1 class="h3 mt-2">Conversor de Divisas con LLM Tool</h1>
            <p class="text-secondary mb-0">
              Pregunta en español y el agente decide cuándo llamar a la tool de FX.
            </p>
          </div>

          <div class="card shadow-lg p-4">
            <form method="post">
              <div class="mb-3">
                <label class="form-label">Pregunta al agente</label>
                <textarea
                  class="form-control"
                  name="question"
                  rows="3"
                  placeholder="Ejemplo: ¿Cuál es el valor de 10,000 COP en USD hoy?"
                >{{ question or "" }}</textarea>
              </div>
              <button class="btn btn-primary me-2" type="submit">Preguntar</button>
              <button class="btn btn-outline-light" type="submit" name="preset" value="p1">
                Pregunta 1 demo
              </button>
              <button class="btn btn-outline-light" type="submit" name="preset" value="p2">
                Pregunta 2 demo
              </button>
              <button class="btn btn-outline-light" type="submit" name="preset" value="p3">
                Pregunta 3 demo
              </button>
            </form>

            {% if answer %}
            <div class="mt-4 result-box p-3">
              <div class="d-flex justify-content-between align-items-center mb-2">
                <h2 class="h6 text-secondary">Respuesta del agente</h2>
                {% if used_tool %}
                <span class="badge bg-info text-dark">Se usó tool de FX</span>
                {% else %}
                  <span class="badge bg-secondary">Respuesta solo LLM</span>
                {% endif %}
              </div>

              <p class="mb-0">{{ answer }}</p>
            
              {% if fx_info %}
                {% set from_code = fx_info[0] %}
                {% set to_code = fx_info[1] %}
                {% set rate = fx_info[2] %}
                <p class="mb-0 text-secondary small">
                  Tipo de cambio de referencia: 
                  1 {{ from_code }} = {{"%.4f"|format(rate) }} {{ to_code }}
                </p>
                {% endif %}
            </div>
            {% endif %}
          <div class="mt-4 text-center text-secondary small">
            Demo académica · Tipos de cambio aproximados · No usar para decisiones reales.
          </div>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>
